"""
This type stub file was generated by pyright.
"""

from dataclasses import dataclass
from datetime import datetime
from enum import Enum
from ordinis.domain.market_data import Bar
from ordinis.domain.orders import Fill, Order

"""Execution simulation with realistic slippage and commission modeling."""
class FillMode(Enum):
    """Fill modeling granularity."""
    BAR_OPEN = ...
    INTRA_BAR = ...
    REALISTIC = ...


@dataclass
class ExecutionConfig:
    """Configuration for execution simulator.

    Attributes:
        estimated_spread: Estimated bid-ask spread (as fraction, e.g., 0.001 = 0.1%)
        impact_coefficient: Market impact coefficient for slippage
        volatility_factor: Volatility factor for slippage
        max_slippage: Maximum allowed slippage (as fraction)
        commission_per_share: Commission per share
        commission_per_trade: Flat commission per trade
        commission_pct: Commission as percentage of trade value
        min_commission: Minimum commission per trade
        partial_fills: Allow partial fills
        fill_probability: Probability of fill for limit orders
        fill_mode: How to model intrabar fills for market/stop orders
    """
    estimated_spread: float = ...
    impact_coefficient: float = ...
    volatility_factor: float = ...
    max_slippage: float = ...
    commission_per_share: float = ...
    commission_per_trade: float = ...
    commission_pct: float = ...
    min_commission: float = ...
    partial_fills: bool = ...
    fill_probability: float = ...
    fill_mode: FillMode = ...
    def __post_init__(self): # -> None:
        """Validate configuration."""
        ...
    


class ExecutionSimulator:
    """Simulates realistic order execution with slippage and commissions.

    Uses configurable slippage model with three components:
    1. Fixed component (bid-ask spread)
    2. Variable component (market impact based on volume)
    3. Volatility component (based on bar volatility)
    """
    def __init__(self, config: ExecutionConfig | None = ...) -> None:
        """Initialize execution simulator.

        Args:
            config: Execution configuration (uses defaults if None)
        """
        ...
    
    def simulate_fill(self, order: Order, bar: Bar, timestamp: datetime, multiplier: float = ...) -> Fill | None:
        """Simulate order fill for given market conditions.

        Args:
            order: Order to fill
            bar: Current market bar
            timestamp: Fill timestamp
            multiplier: Contract multiplier (default 1.0)

        Returns:
            Fill object if order can be filled, None otherwise
        """
        ...
    


